<Window x:Class="ColorSys.WPF.Views.ConnectView"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:vm="clr-namespace:ColorSys.HardwareImplementation.Communication.CommParamVm;assembly=ColorSys.HardwareImplementation"
        mc:Ignorable="d"
        Title="设备连接" Height="550" Width="500"
        WindowStartupLocation="CenterOwner">

    <Window.Resources>
        <!-- TCP 配置模板 -->
        <DataTemplate DataType="{x:Type vm:TcpParamVm}">
            <StackPanel Margin="10">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="80"/>
                        <ColumnDefinition/>
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="35"/>
                        <RowDefinition Height="35"/>
                    </Grid.RowDefinitions>

                    <TextBlock Text="IP地址：" VerticalAlignment="Center"/>
                    <TextBox Grid.Column="1" Text="{Binding IP}" VerticalAlignment="Center"/>

                    <TextBlock Grid.Row="1" Text="端口号：" VerticalAlignment="Center"/>
                    <TextBox Grid.Row="1" Grid.Column="1" Text="{Binding Port}" 
                             VerticalAlignment="Center" Width="80" HorizontalAlignment="Left"/>
                </Grid>
            </StackPanel>
        </DataTemplate>

        <!-- 串口配置模板 -->
        <DataTemplate DataType="{x:Type vm:SerialParamVm}">
            <StackPanel Margin="10">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="80"/>
                        <ColumnDefinition/>
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="35"/>
                        <RowDefinition Height="35"/>
                        <RowDefinition Height="35"/>
                        <RowDefinition Height="35"/>
                        <RowDefinition Height="35"/>
                    </Grid.RowDefinitions>

                    <TextBlock Text="端口号：" VerticalAlignment="Center"/>
                    <ComboBox Grid.Column="1" ItemsSource="{Binding AvailablePorts}" 
                              SelectedItem="{Binding PortName}" VerticalAlignment="Center"/>

                    <TextBlock Grid.Row="1" Text="波特率：" VerticalAlignment="Center"/>
                    <ComboBox Grid.Row="1" Grid.Column="1" ItemsSource="{Binding BaudRates}" 
                              SelectedItem="{Binding BaudRate}" VerticalAlignment="Center"/>

                    <TextBlock Grid.Row="2" Text="数据位：" VerticalAlignment="Center"/>
                    <ComboBox Grid.Row="2" Grid.Column="1" ItemsSource="{Binding DataBitsList}" 
                              SelectedItem="{Binding DataBits}" VerticalAlignment="Center"/>

                    <TextBlock Grid.Row="3" Text="校验位：" VerticalAlignment="Center"/>
                    <ComboBox Grid.Row="3" Grid.Column="1" ItemsSource="{Binding Parities}" 
                              SelectedItem="{Binding Parity}" VerticalAlignment="Center"/>

                    <TextBlock Grid.Row="4" Text="停止位：" VerticalAlignment="Center"/>
                    <ComboBox Grid.Row="4" Grid.Column="1" ItemsSource="{Binding StopBitsList}" 
                              SelectedItem="{Binding StopBits}" VerticalAlignment="Center"/>
                </Grid>
            </StackPanel>
        </DataTemplate>

        <!-- 蓝牙配置模板（预留） -->
      
    </Window.Resources>

    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <!--<RowDefinition Height="Auto"/>-->
        </Grid.RowDefinitions>

        <!-- 仪器类型 -->
        <StackPanel Orientation="Horizontal" Margin="5">
            <TextBlock Text="仪器类型：" Width="80" VerticalAlignment="Center"/>
            <ComboBox ItemsSource="{Binding DeviceStrategies}" 
                      SelectedItem="{Binding SelectedDeviceStrategy}"
                      DisplayMemberPath="DisplayName" Width="200"/>
        </StackPanel>

        <!-- 连接方式 -->
        <StackPanel Grid.Row="1" Orientation="Horizontal" Margin="5">
            <TextBlock Text="连接方式：" Width="80" VerticalAlignment="Center"/>
            <ComboBox ItemsSource="{Binding CommStrategies}" 
                      SelectedItem="{Binding SelectedCommStrategy}"
                      DisplayMemberPath="DisplayName" Width="200"/>
        </StackPanel>

        <!-- 动态参数面板 -->
        <Border Grid.Row="2" BorderBrush="#FFCCCCCC" BorderThickness="1" 
                Margin="5" CornerRadius="3" MinHeight="150">
            <ContentControl Content="{Binding CurrentConfigViewModel}" 
                          VerticalAlignment="Stretch"/>
        </Border>

        <!-- 连接状态提示（可选） -->
        <!--<TextBlock Grid.Row="3" Text="{Binding StatusMessage}" 
                   Foreground="Gray" HorizontalAlignment="Center" Margin="10"/>-->

        <!-- 按钮 -->
        <StackPanel Grid.Row="3" Orientation="Horizontal" 
                    HorizontalAlignment="Center" Margin="10">
            <Button Content="连接" Command="{Binding ConnectCommand}" 
                    CommandParameter="{Binding RelativeSource={RelativeSource AncestorType=Window}}"
                    Width="80" Margin="10" IsDefault="True"/>
            <Button Content="取消" Command="{Binding CancelCommand}" 
                    CommandParameter="{Binding RelativeSource={RelativeSource AncestorType=Window}}"
                    Width="80" Margin="10" IsCancel="True"/>
        </StackPanel>
    </Grid>
</Window>